# Mile Buy Club - Environment Variables Template
# Copy this file to .env.local and fill in actual values
# DO NOT commit sensitive values to git

# ============================================================================
# DATABASE
# ============================================================================

# PostgreSQL connection string
DATABASE_URL="postgresql://dev:devpass@localhost:5432/milebyclub?schema=public"

# ============================================================================
# REDIS
# ============================================================================

# Redis connection (used for caching, sessions, rate limiting, jobs)
REDIS_URL="redis://localhost:6379"

# ============================================================================
# NEXT.JS FRONTEND (apps/web)
# ============================================================================

# API endpoint for frontend to call backend
NEXT_PUBLIC_API_URL="http://localhost:3001"

# NextAuth configuration
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-super-secret-key-change-this-in-production-min-64-chars-long-random-string"

# OAuth providers (generate at Google Cloud Console)
GOOGLE_CLIENT_ID="your-google-client-id.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="your-google-client-secret"

# ============================================================================
# NESTJS BACKEND (apps/api)
# ============================================================================

# Server port
PORT=3001

# JWT configuration
JWT_SECRET="your-jwt-secret-key-min-64-chars-long-change-in-production"
JWT_EXPIRATION="7d"

# CORS - which origins can access the API
CORS_ORIGIN="http://localhost:3000"

# ============================================================================
# EMAIL SERVICE (SES)
# ============================================================================

# AWS SES configuration for sending emails
AWS_REGION="us-east-1"
AWS_ACCESS_KEY_ID="your-aws-access-key"
AWS_SECRET_ACCESS_KEY="your-aws-secret-key"

# Email settings
MAIL_FROM_ADDRESS="noreply@milebyclub.com"
MAIL_FROM_NAME="Mile Buy Club"
MAIL_HOST="localhost"
MAIL_PORT=1025
ENABLE_EMAIL_NOTIFICATIONS=true

# For local development with Mailhog
# Override above with:
# SMTP_HOST="localhost"
# SMTP_PORT="1025"

# ============================================================================
# EXTERNAL APIS & INTEGRATIONS
# ============================================================================

# Flight search APIs (to be implemented)
# Seats.aero award availability
SEATS_AERO_API_KEY="pro_34GoHwfqK5fP3esJgqAhxv4cOmj"
SEATS_AERO_BASE_URL="https://seats.aero/partnerapi"
SEATS_AERO_PROGRAM="*"
SEATS_AERO_RPM=30
SEATS_AERO_RPH=500

# Hotel APIs
# BOOKING_AFFILIATE_ID="your-booking.com-affiliate-id"
# EXPEDIA_AFFILIATE_ID="your-expedia-affiliate-id"

# Activity APIs
# VIATOR_API_KEY="your-viator-api-key"
# GETYOURGUIDE_API_KEY="your-getyourguide-api-key"

# Affiliate networks
# IMPACT_ACCOUNT_SID="your-impact-account-sid"
# CJ_API_KEY="your-cj-api-key"

# ============================================================================
# AI ORCHESTRATION & INTELLIGENT FEATURES
# ============================================================================

# OpenAI / ChatGPT configuration for trip planning & conversations
OPENAI_API_KEY="your-openai-api-key"
OPENAI_MODEL="gpt-4.1"
OPENAI_PLANNER_TEMPERATURE=0.4

# Vision model for photo/video location recognition
OPENAI_VISION_MODEL="gpt-4.1-mini"
OPENAI_VISION_TEMPERATURE=0.1

# Optional: Azure Maps or Google Places API for geocoding AI inferences
# GEOLOCATION_PROVIDER="google"
# GOOGLE_PLACES_API_KEY="your-google-places-key"

# ============================================================================
# AFFILIATE & TRACKING
# ============================================================================

# Affiliate tracking configuration
AFFILIATE_COOKIE_DURATION=2592000  # 30 days in seconds
AFFILIATE_DEFAULT_COMMISSION_RATE=0.05  # 5% default

# Analytics (privacy-focused, server-side only)
ENABLE_ANALYTICS=true

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Disable expensive features during development
ENABLE_HOTEL_SEARCH=true
ENABLE_ACTIVITY_SEARCH=true
ENABLE_CARD_RECOMMENDATIONS=true
ENABLE_NOTIFICATIONS=true

# Job scheduling
ENABLE_WATCHER_JOBS=true
ENABLE_DIGEST_JOBS=true

# ============================================================================
# RATE LIMITING & QUOTAS
# ============================================================================

# Global rate limits (requests per time window)
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100

# Per-user watcher limits
FREE_TIER_MAX_WATCHERS=5
PREMIUM_TIER_MAX_WATCHERS=50

# API call rate limiting for external services
FLIGHT_API_RATE_LIMIT=10  # calls per minute
HOTEL_API_RATE_LIMIT=20
ACTIVITY_API_RATE_LIMIT=20

# ============================================================================
# CACHING
# ============================================================================

# Cache TTL values (in seconds)
CACHE_TTL_DEALS=7200  # 2 hours
CACHE_TTL_FLIGHTS=3600  # 1 hour
CACHE_TTL_HOTELS=21600  # 6 hours
CACHE_TTL_ACTIVITIES=21600  # 6 hours

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

# Log level: error, warn, info, debug
LOG_LEVEL=info

# Enable detailed request logging (disable in production)
LOG_REQUESTS=true

# Send critical errors to monitoring service (optional)
# SENTRY_DSN="https://your-sentry-dsn"

# Prometheus metrics
ENABLE_METRICS=true

# ============================================================================
# SECURITY
# ============================================================================

# Password hashing
BCRYPT_ROUNDS=12

# ENCRYPTION for PII fields
ENCRYPTION_KEY="your-encryption-key-min-32-chars-random"

# Content Security Policy
CSP_ENABLED=true

# HTTPS enforcement (enable in production)
HTTPS_REDIRECT=false

# ============================================================================
# DEVELOPMENT ONLY
# ============================================================================

# Seed database with demo data on startup
SEED_DATABASE=false

# Disable authentication for testing (NEVER enable in production)
DISABLE_AUTH=false

# Verbose error messages (disable in production)
DETAILED_ERRORS=true

# ============================================================================
# BUSINESS CONFIGURATION
# ============================================================================

# Minimum CPP value to show deal (value threshold)
MIN_DEAL_CPP=1.0

# Default notification threshold (cents per point)
DEFAULT_NOTIFICATION_THRESHOLD=1.5

# Value calculation settings
ECONOMY_VALUE_THRESHOLD=1.0
BUSINESS_VALUE_THRESHOLD=2.0
FIRST_VALUE_THRESHOLD=3.0

# ============================================================================
# NOTES
# ============================================================================

# PRODUCTION DEPLOYMENT:
# 1. Generate strong random strings for all _SECRET and _KEY variables
# 2. Use AWS Secrets Manager or similar for sensitive values
# 3. Never commit .env files with real secrets
# 4. Use environment-specific configs (staging vs production)
# 5. Enable HTTPS_REDIRECT and DETAILED_ERRORS=false
# 6. Set LOG_LEVEL=error
# 7. Use real SES or SendGrid for email
# 8. Configure real affiliate network credentials

# LOCAL DEVELOPMENT:
# 1. Copy this to .env.local
# 2. Can use placeholder values for external APIs
# 3. Use Mailhog for email (port 1025)
# 4. Use Docker Compose PostgreSQL and Redis (localhost:5432, localhost:6379)
# 5. Disable external API calls if not implementing yet
